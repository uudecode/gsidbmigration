2017-04-01 09:38:13 [main] INFO  ru.spb.trak.gsi.Application - Wonderfukk! We started at least!!!
2017-04-01 09:38:13 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:38:13 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:38:13 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:38:13 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:38:13 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT COUNT(*) CNT
                    FROM (select * FROM (SELECT f.ILI_INSPECTION_ID ILI_INSPECTION_ID,
                    coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END,
                    calc.sto_292_2007_damage_mechanical,
                    calc.sto_292_2007_value_weld,
                    calc.sto_292_2007_damage_crack,
                    calc.sto_292_2007_damage_corrosion,
                    calc.sto_292_2007_damage_dent,
                    calc.sto_292_2007_value_pipe,
                    calc.sto_292_2007_damage_duty_var,
                    calc.sto_292_2007_bad_pipe_count,
                    calc.sto_292_2007_value_condition,
                    calc.priority_cond,
                    calc.priority_time_exp,
                    calc.priority_probab,
                    calc.priority_time_fai,
                    calc.priority_summary
                    FROM centerline c JOIN pods.sto_ili_inspection_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id WHERE calc.ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1 AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one ) x01
                
            
2017-04-01 09:38:14 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 09:41:26 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_VALUE_CONDITION_CNT]
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[HIGH_LIMIT]:FLOAT8 '+infinity' 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[LOW_LIMIT]:1 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[ORDER_COLUMNS]:ID 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - var[COLUMNS_FILTER]:* 
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:41:26 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT *
                    FROM (SELECT ROW_NUMBER () OVER (ORDER BY ID) RWN, all_in_one.ID, all_in_one.ILI_INSPECTION_ID, all_in_one.SRV_DISTRICT_ID, all_in_one.SRV_DISTRICT_LBL, all_in_one.ILI_INSPECTION_LBL, all_in_one.STATION_BEG, all_in_one.STATION_END, all_in_one.DANGER_DEG, all_in_one.DANGER_DEG_SEGMENT_TYPE, all_in_one.SEGMENT_CATEGORY, all_in_one.CORR_TIME_TO_CRITICAL_DEPTH, all_in_one.SEGMENT_INTENSIVE_DEG_RATE, all_in_one.CORR_AVER_SPEED, all_in_one.CORR_CRITICAL_DEPTH
                    FROM (SELECT coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END,
                    calc.*
                    FROM centerline c JOIN pods.sto_ehz_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one
                    WHERE ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1) sorted
                    WHERE RWN BETWEEN 1  AND FLOAT8 '+infinity'
                
            
2017-04-01 09:41:26 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 09:44:43 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_DANGER_DEG]
2017-04-01 09:44:43 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:44:43 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:44:43 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:44:43 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:44:43 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT COUNT(*) CNT
                    FROM (select * FROM (SELECT f.ILI_INSPECTION_ID ILI_INSPECTION_ID,
                    coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END
                    FROM centerline c JOIN pods.sto_ehz_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id WHERE calc.ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1 AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one ) x01
                
            
2017-04-01 09:44:43 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 09:48:10 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_DANGER_DEG_CNT]
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[HIGH_LIMIT]:FLOAT8 '+infinity' 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[LOW_LIMIT]:1 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[ORDER_COLUMNS]:ID 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - var[COLUMNS_FILTER]:* 
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:48:10 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT *
                    FROM (SELECT ROW_NUMBER () OVER (ORDER BY ID) RWN,all_in_one.ID, all_in_one.ILI_INSPECTION_ID, all_in_one.SRV_DISTRICT_ID, all_in_one.SRV_DISTRICT_LBL, all_in_one.ILI_INSPECTION_LBL, all_in_one.STATION_BEG, all_in_one.STATION_END, all_in_one.DANGER_DEG, all_in_one.DANGER_DEG_SEGMENT_TYPE, all_in_one.SEGMENT_CATEGORY, all_in_one.CORR_TIME_TO_CRITICAL_DEPTH, all_in_one.SEGMENT_INTENSIVE_DEG_RATE, all_in_one.CORR_AVER_SPEED, all_in_one.CORR_CRITICAL_DEPTH

                    FROM (SELECT coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END,
                    calc.*
                    FROM centerline c JOIN pods.sto_ehz_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one
                    WHERE ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1) sorted
                    WHERE RWN BETWEEN 1  AND FLOAT8 '+infinity'
                
            
2017-04-01 09:48:10 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 09:51:17 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_SEGMENT_CATEGORY]
2017-04-01 09:51:17 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:51:17 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:51:17 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:51:17 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:51:17 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT COUNT(*) CNT
                    FROM (select *  FROM (SELECT f.ILI_INSPECTION_ID ILI_INSPECTION_ID,
                    coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END
                    FROM centerline c JOIN pods.sto_ehz_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id WHERE calc.ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1 AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one ) x01
                
            
2017-04-01 09:51:17 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 09:54:33 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_SEGMENT_CATEGORY_CNT]
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[HIGH_LIMIT]:FLOAT8 '+infinity' 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[LOW_LIMIT]:1 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[ORDER_COLUMNS]:ID 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - var[COLUMNS_FILTER]:* 
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:54:33 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT *
                    FROM (SELECT ROW_NUMBER () OVER (ORDER BY ID) RWN,all_in_one.ID, all_in_one.ILI_INSPECTION_ID, all_in_one.SRV_DISTRICT_ID, all_in_one.SRV_DISTRICT_LBL, all_in_one.ILI_INSPECTION_LBL, all_in_one.STATION_BEG, all_in_one.STATION_END, all_in_one.DANGER_DEG, all_in_one.DANGER_DEG_SEGMENT_TYPE, all_in_one.SEGMENT_CATEGORY, all_in_one.CORR_TIME_TO_CRITICAL_DEPTH, all_in_one.SEGMENT_INTENSIVE_DEG_RATE, all_in_one.CORR_AVER_SPEED, all_in_one.CORR_CRITICAL_DEPTH

                    FROM (SELECT coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END,
                    calc.*
                    FROM centerline c JOIN pods.sto_ehz_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one
                    WHERE ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1) sorted
                    WHERE RWN BETWEEN 1  AND FLOAT8 '+infinity'
                
            
2017-04-01 09:54:33 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 09:57:44 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_TIME_TO_CRIT_DEPTH]
2017-04-01 09:57:44 [main] DEBUG ru.spb.trak.gsi.Query - var[FILTER]:1=1 
2017-04-01 09:57:44 [main] DEBUG ru.spb.trak.gsi.Query - var[LPU_ACCESS_FILTER]:SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL 
2017-04-01 09:57:44 [main] DEBUG ru.spb.trak.gsi.Query - var[ILI_INSP_FILTER]:SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION 
2017-04-01 09:57:44 [main] DEBUG ru.spb.trak.gsi.Query - Found 0 binds!
2017-04-01 09:57:44 [main] DEBUG ru.spb.trak.gsi.Query - Changed query: 
                    WITH centerline AS (SELECT lpu.SRV_DISTRICT_ID
                    ,lpu.description srv_district_lbl
                    ,spb.station station_beg
                    ,spe.station station_end
                    ,ser.station_begin insp_station_beg
                    ,ser.station_end insp_station_end
                    ,er.event_id
                    ,er.length
                    ,er.feature_id
                    ,er.current_indicator_lf
                    ,ll.description line_id_lbl
                    ,ll.line_id
                    ,r.route_id
                    ,r.description route_id_lbl
                    FROM pods.event_range er
                    JOIN pods.station_point spb
                    ON spb.station_id = er.station_id_begin
                    JOIN pods.station_point spe
                    ON spe.station_id = er.station_id_end
                    JOIN pods.location l
                    ON l.location_id = spb.location_id
                    JOIN pods.srv_district_gcl lpu
                    ON CASE WHEN l.srv_district_gcl IS NULL THEN 0 ELSE l.srv_district_gcl END = lpu.srv_district_id
                    join pods.series ser on spb.series_id=ser.series_id
                    join pods.line ll on ser.line_id=ll.line_id
                    join pods.route r on ser.route_id=r.route_id
                    WHERE er.current_indicator_lf = 'Y')
                    SELECT COUNT(*) CNT
                    FROM (select * FROM (SELECT f.ILI_INSPECTION_ID ILI_INSPECTION_ID,
                    coalesce (C.SRV_DISTRICT_ID, 0) SRV_DISTRICT_ID,
                    coalesce (C.SRV_DISTRICT_LBL, 'Неизвестно') SRV_DISTRICT_LBL,
                    CASE WHEN c.line_id = 0 THEN 'Отчет не рассчитан. ' ELSE  '' END||CASE WHEN c.line_id = 0 THEN c.route_id_lbl ELSE c.line_id_lbl END||' ('||c.insp_station_beg||'-' ||c.insp_station_end||'),' || to_char(f.begin_date,'DD.MM.YY')|| (select iv.description from pods.ili_tool_vendor_cl iv where f.tool_vendor_cl=iv.code) ILI_INSPECTION_LBL,
                    calc.event_id id,
                    C.STATION_BEG,
                    C.STATION_END
                    FROM centerline c JOIN pods.sto_ehz_calc calc ON c.event_id = calc.event_id and c.current_indicator_lf='Y' and c.feature_id='INTERVAL_REGULAR' and c.length=100
                    JOIN pods.ili_inspection f ON calc.ili_inspection_id = f.ili_inspection_id WHERE calc.ILI_INSPECTION_ID IN (SELECT ILI_INSPECTION_ID FROM PODS.ILI_INSPECTION) AND 1=1 AND CASE WHEN SRV_DISTRICT_ID IS NULL THEN 0 ELSE SRV_DISTRICT_ID END IN (SELECT srv_district_id FROM PODS.SRV_DISTRICT_GCL)) all_in_one ) x01
                
            
2017-04-01 09:57:44 [main] INFO  ru.spb.trak.gsi.Query - Conection info: TEST
2017-04-01 10:00:59 [main] INFO  ru.spb.trak.gsi.Query - QUERY OK! File: [xmls2\PODS_GRID_XXX.xml] Table:[PODS_STO_100_TIME_TO_CRIT_DEPTH_CNT]
2017-04-01 10:01:00 [main] INFO  ru.spb.trak.gsi.Application - Lol, I came.
